<html>
  <head>
    <meta charset="utf-8">
    <title>SDK playground - Streaming</title>
    <script src="https://connect.soundcloud.com/sdk/sdk-3.1.2.js"></script>
    <script>
      SC.initialize({
        client_id: '52Q7VQ7hzBBAtE1AlxczqQHoBlBFaUBY',
      redirect_uri: 'http://example.com/callback'
      });
    </script>
    <script type="text/javascript" src="../sdk.js"></script>

    <style media="screen">
      body {
        display: flex;
        flex-direction: column;
        align-items: center;
        font-family: sans-serif;
      }
      input {
        font-size: 20px;
      }
      #info {
        display: none;
      }
      input, p {
        width: 90%;
        margin-bottom: 10px;
        margin-top: 0;
      }
      @media (min-width: 500px) {
        input, p {
          width: 500px;
        }
      }
    </style>
  </head>
  <body>
    <form id="searchForm">
      <input type="text" id="url" placeholder="A track's URL" autofocus />
    </form>
    <div id="info">
      <span id="title"></span>
      <button id="play">play</button>
      <button id="pause">pause</button>
    </div>
 


    <script type="text/javascript">
      SC.initialize({
        client_id: '52Q7VQ7hzBBAtE1AlxczqQHoBlBFaUBY'
      });
      var inputField = document.getElementById('url');
      var title = document.getElementById('title');
      var info = document.getElementById('info');
      var currentPlayer;
      var streamTrack = function(track){
        return SC.stream('/tracks/' + track.id).then(function(player){
          title.innerText = track.title;
          info.style.display = 'inline-block';
          if (currentPlayer) {
            currentPlayer.pause();
          }
          currentPlayer = player;
          player.play();
        }).catch(function(){
          console.log(arguments);
        });
      };
      var search = function(event){
        event.preventDefault();
        SC.resolve(inputField.value).then(streamTrack);
      };
      document.getElementById('searchForm').addEventListener('submit', search);
      document.getElementById('pause').addEventListener('click', function(){
        if (currentPlayer) {
          currentPlayer.pause();
        }
      });
      document.getElementById('play').addEventListener('click', function(){
        if (currentPlayer) {
          currentPlayer.play();
        }
      });
    </script>

    <script type="text/javascript">
       var i1 = 0; 
    var currentSong = 0; //song index
    var currentMusicState = 'play';
    var song = { 
        title: [],
        artist: [],
        id: []
    };
    SC.initialize({
            client_id: 'my client id'
        });
        SC.get('/playlists/234357794').then(function (playlist) {
            playlist.tracks.forEach(function (track) {
                song.id[i1] = track.id;
                song.title[i1] = track.title;
                song.artist[i1] = track.user.username;
                i1++;
            });
        });
    </script>
    <script type="text/javascript">
    SC.stream(('/tracks/' + song.id[currentSong])).then(function (musicPlayer) {
                musicPlayer.play();
                currentMusicState = 'play'; 
                if (currentSong < song.id.length) {
                    currentSong++; //next index for next song id
                }
                else{
                    currentSong = 0; //else loop back to first song
                }
                musicPlayer.on('finish', function(){ //this does nothing, but I'm pretty sure I'm during this wrong
                    playMusic(); //recursive function call
                });
            });
    </script>
  </body>
</html>